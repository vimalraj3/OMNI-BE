"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = __importDefault(require("express"));
const investment_controller_1 = require("../controllers/investment.controller");
const investment_service_1 = require("../services/investment.service");
const user_entity_1 = require("../entities/user.entity");
const dataSource_1 = require("../configs/dataSource");
const investment_entity_1 = require("../entities/investment.entity");
const auth_middleware_1 = __importDefault(require("../middlewares/auth.middleware"));
const earnings_entity_1 = require("../entities/earnings.entity");
const return_entity_1 = require("../entities/return.entity");
const Return_controller_1 = require("../controllers/Return.controller");
const router = express_1.default.Router();
let userRepository = dataSource_1.dataSource.getRepository(user_entity_1.User);
let investmentRepository = dataSource_1.dataSource.getRepository(investment_entity_1.Investment);
let earningHistoryRepository = dataSource_1.dataSource.getRepository(earnings_entity_1.Earning);
let investmentService = new investment_service_1.InvestmentService(userRepository, earningHistoryRepository);
let returnRepository = dataSource_1.dataSource.getRepository(return_entity_1.Return);
let returnService = new Return_controller_1.ReturnController(userRepository, returnRepository);
let investmentController = new investment_controller_1.InvestmentController(investmentService, userRepository, investmentRepository, earningHistoryRepository, returnService);
router.use(auth_middleware_1.default);
router.post("/invest", investmentController.createInvestment);
router.post("/rate", returnService.createReturn);
exports.default = router;
